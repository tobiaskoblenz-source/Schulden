<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login ‚Äì Schulden Manager</title>
  <link rel="manifest" href="./manifest.webmanifest">
  <style>
    :root{--bg:#0f172a;--card:#1e293b;--panel:#111827;--text:#f1f5f9;--muted:#94a3b8;--accent:#e6b8a2;}
    body{margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:linear-gradient(180deg,#1e293b,#0f172a);color:var(--text);}
    .container{max-width:520px;margin:auto;padding:20px;}
    .card{background:var(--card);border-radius:22px;padding:20px;margin-top:70px;border:1px solid rgba(255,255,255,.06);box-shadow:0 10px 30px rgba(0,0,0,.45);text-align:center;}
    input,button{padding:12px 16px;margin:8px 0;border-radius:14px;border:1px solid rgba(255,255,255,.08);font-size:16px;background:var(--panel);color:var(--text);width:100%;}
    button{background:var(--accent);color:#1e293b;font-weight:700;cursor:pointer;}
    button.secondary{background:var(--panel);color:var(--text);}
    .muted{color:var(--muted);font-size:14px;}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h2 style="margin:0 0 6px 0;">üîê Schulden Manager</h2>
      <div class="muted" style="margin-bottom:14px;">Bitte einloggen, um deine Daten zu laden.</div>

      <input id="email" type="email" placeholder="E-Mail" autocomplete="email" />
      <input id="pass" type="password" placeholder="Passwort (min. 6 Zeichen)" autocomplete="current-password" />

      <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:6px;">
        <button id="login" type="button" style="flex:1;min-width:160px;">Login</button>
        <button id="register" class="secondary" type="button" style="flex:1;min-width:160px;">Registrieren</button>
      </div>

      <div id="status" class="muted" style="margin-top:12px;">Nicht eingeloggt</div>
    </div>
  </div>

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(console.error);
      });
    }
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCWAvq7GuEhF2jaL8xFrb_MJ34_dZD0Hkk",
      authDomain: "schulden-36186.firebaseapp.com",
      projectId: "schulden-36186",
      storageBucket: "schulden-36186.firebasestorage.app",
      messagingSenderId: "483402986505",
      appId: "1:483402986505:web:1bf7cafce628bbd486b4d8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const $ = (id) => document.getElementById(id);

    onAuthStateChanged(auth, (user) => {
      if (user) location.replace("./app.html");
    });

    $("login").onclick = async () => {
      try{
        await signInWithEmailAndPassword(auth, $("email").value.trim(), $("pass").value);
        location.replace("./app.html");
      } catch(e){
        console.error(e);
        $("status").textContent = e?.message || String(e);
      }
    };

    $("register").onclick = async () => {
      try{
        await createUserWithEmailAndPassword(auth, $("email").value.trim(), $("pass").value);
        location.replace("./app.html");
      } catch(e){
        console.error(e);
        $("status").textContent = e?.message || String(e);
      }
    };
  </script>
</body>
</html>